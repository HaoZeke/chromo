
      SUBROUTINE DECPAR (LA,P0,ND,LL,P)
C-----------------------------------------------------------------------
C...This subroutine generates the decay of a particle
C.  with ID = LA, and 5-momentum P0(1:5)
C.  into ND particles of 5-momenta P(j,1:5) (j=1:ND)
C.
C.  If the initial particle code is LA=0
C.  then ND and LL(1:ND) are considered as  input and
C.  the routine generates a phase space decay into ND
C.  particles of codes LL(1:nd)
C.
C.  june 1992
C.  This version  contains the decay of polarized muons
C.  The muon codes are  L =  4 : mu+ R
C.                          -4 : mu+ L
C.                           5 : mu- L
C.                          -5 : mu- R
C-----------------------------------------------------------------------
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      SAVE
c$$$      COMMON /S_CSYDEC/ CBR(223+22), KDEC(1338+6*22), LBARP(99), IDB(99)
c$$$      COMMON /S_MASS1/ AM(99), AM2(99)
      INCLUDE 'sib_csydec_cmmn.inc'
      INCLUDE 'sib_mass_cmmn.inc'
      DIMENSION P0(5), LL(10), P(10,5)
      DIMENSION PV(10,5), RORD(10), UE(3),BE(3)
      INCLUDE 'sib_utl_cmmn.inc'
      
C...Phase space decay into the particles in the list
      IF (LA .EQ. 0)  THEN
          MAT = 0
          MBST = 0
          PS = ZERO
          DO J=1,ND
CDH          following statements corrected by D.H. dec 20.,1995
             P (J,5) = AM(IABS(LL(J)))
             PV(J,5) = AM(IABS(LL(J)))
             PS = PS+P(J,5)
          ENDDO
          DO J=1,4
             PV(1,J) = P0(J)
          ENDDO
          PV(1,5) = P0(5)
          GOTO 140
      ENDIF
         
C...Choose decay channel
      L = IABS(LA)
      ND=0
      IDC = IDB(L)-1
      IF (IDC+1 .LE.0)  RETURN
      RBR = S_RNDM(0)
110   IDC=IDC+1
      IF(RBR.GT.CBR(IDC))  GOTO 110

      KD =6*(IDC-1)+1
      ND = KDEC(KD)
      MAT= KDEC(KD+1)
      MBST=0
      IF (MAT .GT.0 .AND. P0(4) .GT. 20*P0(5)) MBST=1
      IF (MAT .GT.0 .AND. MBST .EQ. 0) 
     +        BETA = dSQRT(P0(1)**2+P0(2)**2+P0(3)**2)/P0(4)
      PS = ZERO
c     reduce omega mass by 50MeV to allow on-shell N(1710) decay
      Xmomega = am(32)
      IF(L.eq.53.or.L.eq.54) AM(32) = AM(32)-0.05D0
      DO J=1,ND
         LL(J) = KDEC(KD+1+J)
         P(J,5)  = AM(LL(J))
         PV(J,5) = AM(LL(J))
         PS = PS + P(J,5)
      ENDDO
      AM(32) = Xmomega
      DO J=1,4
         PV(1,J) = ZERO
         IF (MBST .EQ. 0)  PV(1,J) = P0(J)
      ENDDO
      IF (MBST .EQ. 1)  PV(1,4) = P0(5)
      PV(1,5) = P0(5)

140   IF (ND .EQ. 2) GOTO 280

      IF (ND .EQ. 1)  THEN
         DO J=1,4
            P(1,J) = P0(J)
         ENDDO
         RETURN
      ENDIF

C...Calculate maximum weight for ND-particle decay
      WWTMAX = ONE/FACN(ND)      
      PMAX=PV(1,5)-PS+P(ND,5)
      PMIN=ZERO
      DO IL=ND-1,1,-1
         PMAX = PMAX+P(IL,5)
         PMIN = PMIN+P(IL+1,5)
         WWTMAX = WWTMAX*PAWT(PMAX,PMIN,P(IL,5))
      ENDDO

C...generation of the masses, compute weight, if rejected try again
240   RORD(1) = ONE
      DO 260 IL1=2,ND-1
      RSAV = S_RNDM(0)
      DO 250 IL2=IL1-1,1,-1
      IF(RSAV.LE.RORD(IL2))   GOTO 260
250     RORD(IL2+1)=RORD(IL2)
260     RORD(IL2+1)=RSAV
      RORD(ND) = ZERO
      WT = ONE      
      DO 270 IL=ND-1,1,-1
      PV(IL,5)=PV(IL+1,5)+P(IL,5)+(RORD(IL)-RORD(IL+1))*(PV(1,5)-PS)
270   WT=WT*PAWT(PV(IL,5),PV(IL+1,5),P(IL,5))
      IF (WT.LT.S_RNDM(0)*WWTMAX)   GOTO 240

C...Perform two particle decays in respective cm frame
280   DO 300 IL=1,ND-1
      PA=PAWT(PV(IL,5),PV(IL+1,5),P(IL,5))
      UE(3)=TWO*S_RNDM(0)-ONE
      PHI=TWO*PI*S_RNDM(0)
      UT = dSQRT(ONE-UE(3)**2)
      UE(1) = UT*dCOS(PHI)
      UE(2) = UT*dSIN(PHI)
      DO 290 J=1,3
      P(IL,J)=PA*UE(J)
290   PV(IL+1,J)=-PA*UE(J)
      P(IL,4)=dSQRT(PA**2+P(IL,5)**2)
300   PV(IL+1,4)=dSQRT(PA**2+PV(IL+1,5)**2)

C...Lorentz transform decay products to lab frame
      DO 310 J=1,4
310   P(ND,J)=PV(ND,J)
      DO 340 IL=ND-1,1,-1
      DO 320 J=1,3
320   BE(J)=PV(IL,J)/PV(IL,4)
      GA=PV(IL,4)/PV(IL,5)
      DO 340 I=IL,ND
      BEP = BE(1)*P(I,1)+BE(2)*P(I,2)+BE(3)*P(I,3)
      DO 330 J=1,3
330   P(I,J)=P(I,J)+GA*(GA*BEP/(ONE+GA)+P(I,4))*BE(J)
340   P(I,4)=GA*(P(I,4)+BEP)
      
C...Weak decays
      IF (MAT .EQ. 1)  THEN
         F1=P(2,4)*P(3,4)-P(2,1)*P(3,1)-P(2,2)*P(3,2)-P(2,3)*P(3,3)      
         IF (MBST.EQ.1)  THEN
C        WT = P0(5)*P(1,4)*F1
            WT = P0(5)*(P(1,4)+DBLE(LA/L)*P(1,3))*F1
         ENDIF
         IF (MBST.EQ.0)  THEN  
            WT=F1*(P(1,4)*P0(4)-P(1,1)*P0(1)-P(1,2)*P0(2)-P(1,3)*P0(3))
            IF(L.lt.50)
     +           WT= WT-DBLE(LA/L)*(P0(4)*BETA*P(1,4)-P0(4)*P(1,3))*F1
         ENDIF
         WTMAX = P0(5)**4/EIGHT
         IF(WT.LT.S_RNDM(0)*WTMAX)   GOTO 240
      ENDIF

C...Boost back for rapidly moving particle
      IF (MBST .EQ. 1)   THEN
         DO 440 J=1,3
440      BE(J)=P0(J)/P0(4)
         GA= P0(4)/P0(5)
         DO 460 I=1,ND
         BEP=BE(1)*P(I,1)+BE(2)*P(I,2)+BE(3)*P(I,3)
         DO 450 J=1,3
450         P(I,J)=P(I,J)+GA*(GA*BEP/(ONE+GA)+P(I,4))*BE(J)
460         P(I,4)=GA*(P(I,4)+BEP)
      ENDIF

C...labels for antiparticle decay
      IF (LA .LT. 0 .AND. L .GT. 18)  THEN
           DO J=1,ND
            LL(J) = LBARP(LL(J))
         ENDDO
      ENDIF

      RETURN
      END


      BLOCK DATA DATDEC
C-----------------------------------------------------------------------
C...initialization of SIBYLL particle data
C-----------------------------------------------------------------------
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      SAVE
      INCLUDE 'sib_csydec_cmmn.inc'
      INCLUDE 'sib_mass_cmmn.inc'
      INCLUDE 'sib_width_cmmn.inc'
      INCLUDE 'sib_chp_cmmn.inc'
      INCLUDE 'sib_cnam_cmmn.inc'
c$$$      COMMON /S_CSYDEC/ CBR(223+22), KDEC(1338+6*22), LBARP(99), IDB(99)
c$$$      COMMON /S_MASS1/ AM(99), AM2(99)
c$$$      COMMON /S_CHP/ ICHP(99), ISTR(99), IBAR(99)
c$$$      COMMON /S_CNAM/ NAMP (0:99)
c$$$      COMMON /S_CHM/ ICHM(99)
c$$$      CHARACTER NAMP*6
      DATA CBR /3*1.0,0.0,1.0,1.0,0.6354,0.8422,0.8981,0.9157,
     + 0.9492,1.0,0.6354,0.8422,0.8981,0.9157,0.9492,1.0,
     + 0.1965,0.3224,0.4579,0.5934,0.7967,1.0,0.6925,1.0,
     + 3*0.0,0.5,1.0,0.5,1.0,0.3941,0.7197,0.9470,0.9930,
     + 1.0,0.0,0.4460,0.6530,0.9470,0.9770,0.9980,4*1.0,
     + 0.6670,1.0,9*0.0,0.6670,1.0,0.6670,1.0,0.6670,1.0,
     + 0.8940,0.9830,1.0,0.4930,0.8340,0.9870,1.0,0.5160,
     + 5*1.0,0.6410,2*1.0,0.67,1.0,0.33,2*1.0,0.88,0.94,1.0,
     + 0.88,0.94,1.0,0.88,0.94,1.0,0.33,1.0,0.67,1.0,0.678,
     + 0.914,1.0, 0.217,0.398,0.506,0.595,0.684,
     + 0.768,0.852,0.923,0.976,1.0, 0.217,0.398,0.506,0.595,
     + 0.684,0.768,0.852,0.923,0.976,1.0, 0.2490,0.4604,
     + 0.5338,0.5703,0.7440,0.7840,0.8460,0.8880,0.9230,0.9650,
     + 1.0,0.2490,0.4604,0.5338,0.5703,0.7440,0.7840,0.8460,
     + 0.8880,0.9230,0.9650,1.0,0.1666,0.3332,0.4998,0.6664,
     + 0.8330,1.0,0.6770,0.9840,1.0,
     + 0.6770,0.9840,1.0, 0.6190,1.0,0.6190,1.0,0.0602,0.1203,
     + 1.0,3*1.0,0.06,0.08,0.14,0.16,0.73,0.855,0.98,1.0,
     + 0.08,0.16,0.92,1.0,0.2335,0.4283,0.6446,0.7099,0.8080,
     + 0.9080,0.9380,0.9540,0.9840,1.0,3*1.0,0.5,1.0,0.5,1.0,
     + 0.08,0.16,0.92,1.0,0.942,1.0,0.942,1.0,0.2493,0.4061,
     + 0.5602,0.6860,0.7608,0.8305,0.8818,0.9277,0.9691,1.0,
     + 0.2493,0.4061,0.5602,0.6860,0.7608,0.8305,0.8818,
     + 0.9277,0.9691,1.0,
     & 0.466,0.7,0.899,1.0, 0.466,0.7,0.899,1.0, ! N1440+-
     & 0.3334,0.5,0.6334,0.7634,0.8734,0.9394,1.0, ! N1710+
     & 0.3334,0.5,0.6334,0.7634,0.8734,0.9394,1.0,  ! N1710-
     & 0.45,0.90,0.95,1.0,0.45,0.90,0.95,1.0,0.45,0.90,0.95,1.0, ! a0+-0
     & 0.6666,1.0, 0.6666,1.0, 0.6666,1.0, 0.6666,1.0/ ! K0*
      DATA AM / 0.0,2*0.511D-3, 2*0.10566, 0.13497, 2*0.13957,
     +   2*0.49368, 2*0.49761, 0.93827, 0.93957, 4*0.0,0.93827,
     +   0.93957, 2*0.49761, 0.54785,0.95766,2*0.76690,0.76850,
     +   2*0.89166D0,2*0.89600,0.78265,1.01946D0,1.18937D0,1.19264D0,
     +   1.19745,1.31486,1.32171,1.11568,1.23100,1.23500,
     +   1.23400,1.23300,1.38280,1.38370,1.38720,
     +   1.53180,1.53500,1.67245,0.,1.44,1.44,1.71,1.71,4*0.0,
     +   2*1.86926,0.992,0.992,0.992,4*1.430, 3*0.0,
     +   2*1.86484,2.9803,2*1.9685,2*2.1123,2*2.01027,2*2.00697,
     +   0.0,3.09692,2.45402,2.4529,2.45376,2.4679,2.4710,
     +   2.28646,4*0.0,2.5184,2.5175, 2.5180, 2.6466,
     +   2.6461, 2.6975 /
      DATA AM2 /0.0,2*2.61121D-07,2*0.011164,0.018217,0.019480,
     + 0.019480,0.243720,0.243720,0.247616,0.247616,0.880351,
     + 0.882792,0.000000,0.000000,0.000000,0.000000,0.880351,
     + 0.882792,0.247616,0.247616,0.300140,0.917113,0.588136,
     + 0.588136,0.590592,0.795058,0.795058,0.802816,0.802816,
     + 0.612541,1.039299,1.414601,1.422390,1.433887,1.728857,
     + 1.746917,1.244742,1.515361,1.525225,1.522765,1.520289,
     + 1.912136,1.914626,1.924324,2.346411,2.356225,2.797022,
     + 0.,2.0736,2.0736,2.9241,2.9241,4*0.0, 2*3.49414,
     + 0.9841,0.9841,0.9841, 4*2.0449, 3*0.0, 2*3.477628, 8.882188, 
     + 2*3.8750,2*4.4618,2*4.041186,2*4.027928, 0.0, 9.590914, 6.022214,
     + 6.016718, 6.020938,6.09053, 6.105841, 5.227899, 4*0.0,
     + 6.342339, 6.337806, 6.340323,7.004492, 7.001845, 7.276506/
      DATA AW /24*0.,0.022231,0.022231,0.022231,0.002581,0.002581,0.0,
     &     0.0,7.20801D-05,1.81476D-05,6*0.,0.013689,
     &     0.013689,0.013689,0.013689,0.001296,0.001295,0.00155,
     &     8.281D-05,9.801D-05,0.,0.,0.09,0.01,0.09,0.01,6*0.,
     &     0.1,0.1,0.1,4*0.27,32*0./
      DATA AW2 /24*0.,0.022231,0.022231,0.022231,0.002581,0.002581,0.0,
     &     0.0,7.20801D-05,1.81476D-05,6*0.,0.013689,
     &     0.013689,0.013689,0.013689,0.001296,0.001295,0.00155,
     &     8.281D-05,9.801D-05,0.,0.,0.09,0.01,0.09,0.01,6*0.,
     &     0.01,0.01,0.01,4*0.0729,32*0./

      DATA IDB /
     + 0,0,0,1,2,3,5,6,7,13,19,25,8*0,30,32,34,40,46,47,48,49,60,62,
     + 64,66,69,73,75,76,77,78,79,81,82,84,86,87,90,93,96,98,100,
     + 0,224,228,232,239,4*0, ! < 59
     + 103,113,246,250,254,258,260,262,264,3*0,
     + 123,134,145,204,214,200,202,151,154,157,159,0,
     + 161,164,165,166,167,175,179,4*0,189,190,191,192,194,196 /
      DATA KDEC /
     + 3,1,15,2,18,0,3,1,16,3,17,0,2,0,1,1,8*0,2,0,4,17,0,0,2,0,5,18,0,
     + 0,2,0,4,17,0,0,2,0,7,6,0,0,3,0,7,7,8,0,3,0,7,6,6,0,3,1,17,4,6,0,
     + 3,1,15,2,6,0,2,0,5,18,0,0,2,0,8,6,0,0,3,0,8,8,7,0,3,0,8,6,6,0,3,
     + 1,18,5,6,0,3,1,16,3,6,0,3,0,6,6,6,0,3,0,7,8,6,0,3,1,18,5,7,0,3,
     + 1,17,4,8,0,3,1,16,3,7,0,3,1,15,2,8,0,2,0,7,8,0,0,2,0,6,6,20*0,1,
     + 0,11,3*0,1,0,12,0,0,0,1,0,11,0,0,0,1,0,12,0,0,0,2,0,1,1,0,0,3,0,
     + 6,6,6,0,3,0,7,8,6,0,3,0,1,7,8,0,3,0,1,3,2,7*0,3,0,7,8,23,0,3,0,6
     + ,6,23,0,2,0,1,27,0,0,2,0,1,32,0,0,2,0,1,1,0,0,3,0,6,6,6,0,2,0,7,
     + 6,0,0,2,0,8,6,0,0,2,0,7,8,0,0,2,0,21,7,0,0,2,0,9,6,0,0,54*0,2,0,
     + 22,8,0,0,2,0,10,6,0,0,2,0,9,8,0,0,2,0,21,6,0,0,2,0,10,7,0,0,
     + 2,0,22,6,0,0,3,0,7,8,6,0,2,0,1,6,0,0,2,0,7,8,0,0,2,0,9,10,0,
     + 0,2,0,11,12,0,0,3,0,7,
     + 8,6,0,2,0,1,23,0,0,2,0,13,6,0,0,2,0,14,7,0,0,2,0,39,1,0,0,2,
     + 0,14,8,0,0,2,0,39,6,0,0,2,0,39,8,0,0,2,0,13,8,0,0,2,0,
     + 14,6,0,0,2,0,13,7,0,0,2,0,13,6,
     + 0,0,2,0,14,7,0,0,2,0,13,8,0,0,2,0,14,6,0,0,2,0,14,8,0,0,2,0,
     + 39,7,0,0,2,0,34,6,0,0,2,0,35,7,0,0,2,0,39,6,0,0,2,0,34,8,0,0,
     + 2,0,36,7,0,0,2,0,39,8,0,0,2,
     + 0,35,8,0,0,2,0,36,6,0,0,2,0,37,6,0,0,2,0,38,7,0,0,2,0,
     + 37,8,0,0,2,0,38,6,0,0,2,0,39,10,0,0,2,0,37,8,0,0,2,0,38,6,0,0,
     + 3,0,22,7,6,0,3,0,22,9,22,0,2,0,22,7,0,0,3,1,2,15,22,0,3,1,4,17,
     + 22,0,3,1,2,15,31,0,3,1,4,17,31,0,2,0,31,25,0,0,3,0,33,7,6,0,
     + 3,0,10,7,7,0,
     + 3,0,21,8,6,0,3,0,21,10,21,0,2,0,21,8,0,0,3,1,3,16,21,0,3,1,5,18,
     + 21,0,3,1,3,16,30,0,3,1,5,18,30,0,2,0,30,26,0,0,3,0,33,8,6,0,
     + 3,0,9,8,8,0,
     + 2,0,29,7,0,0,2,0,31,6,0,0,2,0,22,6,0,0,2,0,10,7,0,0,2,0,31,27,0,
     + 0,2,0,30,27,0,0,2,0,29,25,0,0,3,1,2,15,10,0,3,1,2,15,29,0,
     + 3,1,4,17,10,0,3,1,4,17,29,0,
     + 2,0,28,8,0,0,2,0,30,6,0,0,2,0,21,6,0,0,2,0,9,8,0,0,2,0,30,27,0,
     + 0,2,0,31,27,0,0,2,0,28,26,0,0,3,1,3,16,9,0,3,1,3,16,28,0,
     + 3,1,5,18,9,0,3,1,5,18,28,0,
     + 3,0,6,21,22,0,3,0,6,9,10,0,3,0,23,6,6,0,3,0,23,7,8,0,3,0,24,6,6,
     + 0,3,0,24,7,8,0,
     + 2,0,71,7,0,0,2,0,59,6,0,0,2,0,59,1,0,0,
     + 2,0,72,8,0,0,2,0,60,6,0,0,2,0,60,1,0,0,
     + 2,0,71,6,0,0,2,0,71,1,0,0,2,0,72,6,0,0,2,0,72,1,0,0,
     + 2,0,2,3,0,0,2,0,4,5,0,0,3,0,6,7,8,0,
     + 2,0,89,7,0,0,2,0,89,6,0,0,2,0,89,8,0,0,
     + 3,1,2,15,22,0,3,1,2,15,33,0,3,1,4,17,22,0,3,1,4,17,33,0,2,0,7,22,
     + 0,0,2,0,9,22,0,0,2,0,7,33,0,0,2,0,9,33,0,0,
     + 3,1,2,15,10,0,3,1,4,17,10,0,2,0,7,10,0,0,2,0,9,10,0,0,
     + 3,0,7,10,13,0,3,0,7,22,14,0,3,0,7,8,13,0,3,0,9,10,13,0,3,0,9,22,
     + 14,0,3,0,22,8,40,0,3,1,2,15,39,0,3,1,2,15,14,0,3,1,4,17,39,0,3,
     + 1,4,17,14,0,
     + 2,0,89,7,0,0,2,0,89,6,0,0,2,0,89,8,0,0,
     + 2,0,87,6,0,0,2,0,87,1,0,0,2,0,88,6,0,0,2,0,88,1,0,0,
     + 3,1,2,15,10,0,3,1,4,17,10,0,2,0,7,10,0,0,2,0,9,10,0,0 ,
     + 2,0,74,1,0,0 ,2,0,74,6,0,0 , 2,0,75,1,0,0 ,2,0,75,6,0,0, !C=1,S=1 mesons
     + 2,0,23,25,0,0, 4,0,9,10,7,6, 3,0,9,10,7,0, 2,0,33,7,0,0, 
     + 3,1,23,2,15,0, 3,1,33,2,15,0, 2,0,23,7,0,0, 4,0,12,10,7,7,
     + 2,0,9,12,0,0, 4,0,7,8,7,8, 2,0,23,26,0,0, 4,0,10,9,8,6, !  | D*(_s)
     + 3,0,10,9,8,0, 2,0,33,8,0,0, 3,1,23,3,16,0, 3,1,33,3,16,0,! v
     + 2,0,23,8,0,0, 4,0,12,9,8,8, 2,0,10,12,0,0, 4,0,7,8,7,8, ! ----
     & 2,0,14,7,0,0, 2,0,13,6,0,0, 3,0,14,7,6,0, 3,0,13,7,8,0, ! N-res
     & 2,0,13,8,0,0, 2,0,14,6,0,0, 3,0,13,6,8,0, 3,0,14,7,8,0, 
     & 3,0,14,7,6,0, 3,0,13,7,8,0, 2,0,14,7,0,0, 2,0,13,32,0,0,  
     & 2,0,39,9,0,0, 2,0,13,6,0,0, 2,0,13,23,0,0,
     & 3,0,13,8,6,0, 3,0,14,7,8,0, 2,0,13,8,0,0, 2,0,14,32,0,0,  
     & 2,0,39,21,0,0, 2,0,14,6,0,0, 2,0,14,23,0,0, ! ---
     & 2,0,7,8,0,0, 2,0,23,6,0,0, 2,0,9,10,0,0, 2,0,1,1,0,0,    ! a0 |  
     & 2,0,7,6,0,0, 2,0,23,7,0,0, 2,0,9,22,0,0, 2,0,1,1,0,0, !       v
     & 2,0,8,6,0,0, 2,0,23,8,0,0, 2,0,10,21,0,0, 2,0,1,1,0,0, ! ---
     & 2,0,21,7,0,0, 2,0,9,6,0,0, 2,0,22,8,0,0, 2,0,10,6,0,0,    ! k0* |  
     & 2,0,9,8,0,0, 2,0,21,6,0,0, 2,0,10,7,0,0, 2,0,22,6,0,0/ !        v
      DATA LBARP/1,3,2,5,4,6,8,7,10,9,11,12,-13,-14,16,15,18,17,13,14,
     +  22,21,23,24,26,25,27,29,28,31,30,32,33,-34,-35,-36,-37,-38,-39,
     +  -40,-41,-42,-43,-44,-45,-46,-47,-48,-49,0,-51,-52,-53,-54,4*0,
     +  60,59,61,63,62,65,64,67,66,3*0,72,71,
     +  73,75,74,77,76,79,78,81,80,0,83,-84,-85,-86,-87,-88,-89,4*0,-94,
     +  -95,-96,-97,-98,-99 /
      DATA ICHP /0,1,-1,1,-1,0,1,-1,1,-1,0,0,1,0,4*0,-1,0,4*0, !24
     + 1,-1,0,1,-1,4*0,1,0,-1,0,-1,0,2,1,0,-1,1,0,-1,0,-1,-1,  !49
     + 0,1,0,1,0,4*0,1,-1,0,1,-1,1,-1,0,0,3*0,                 !70
     + 0,0,0,1,-1,1,-1,1,-1,0,0,0,                             !82
     + 0,2,1,0,1,0,1,4*0,2,1,0,1,0,0 / ! charmed baryons

      DATA ISTR /8*0,-1,+1,-1,-1,8*0,-1,+1,5*0,-1,+1,-1,+1,2*0, ! mesons
     +     3*1,2*2,1,4*0,3*1,2*2,3,0,4*0, ! 54
     +     4*0,2*0,3*0,-1,1,-1,1,3*0,2*0,0,-1,1,-1,1,2*0,2*0,0,0, ! 83
     +     3*0,2*1,0,4*0,3*0,2*1,2 / ! charmed baryons
      DATA IBAR /12*0,2*1,4*0,2*-1,13*0,16*1,0,4*1,4*0,
     +     2*0,10*0,2*0,0,4*0,2*0,2*0,0,0,6*1,4*0,6*1 /
      DATA ICHM /58*0,1,-1,10*0,1,-1,0,1,-1,+1,-1,1,-1,1,-1,0,0,
     +     6*1,4*0,6*1/
      DATA NAMP /
     +     '     ','gam   ','e+','e-','mu+','mu-','pi0',
     +     'pi+','pi-','k+', 'k-', 'k0l','k0s',
     +     'p', 'n', 'nue', 'nueb', 'num', 'numb', 'pbar', 'nbar',
     +     'k0', 'k0b', 'eta', 'etap', 'rho+', 'rho-','rho0',
     +     'k*+','k*-','k*0','k*0b','omeg', 'phi', 'SIG+', 'SIG0',
     +     'SIG-','XI0','XI-','LAM','DELT++','DELT+','DELT0','DELT-',
     +     'SIG*+','SIG*0','SIG*-', 'XI*0', 'XI*-', 'OME-',
     +     '     ','N144_+','N144_0','N171_+','N171_0',
     +     4*'     ', 'D+', 'D-','a/f0_0','a/f0_+','a/f0_-',
     +     'k0*_+','k0*_-','k0*_0','k0*_0b',
     +     3*'     ', 'D0', 'D0b', 'eta_c', 
     +     'D_s+','D_s-','D*_s+','D*_s-','D*+', 'D*-', 'D*0', 'D*0b',
     +     '     ', 'J/psi',
     +     'SIGc++', 'SIGc+', 'SIGc0','XI_c+','XI_c0','LAM_c+',
     +     4*'     ', 'SIc*++','SIGc*0','SIGc*-', 'XI_c*+', 'XI_c*0',
     +     'OME_c0'  /
      END
C->
      SUBROUTINE DECPR (LUN)
C...Print on unit LUN the list of particles and decay channels
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      SAVE
      INCLUDE 'sib_csydec_cmmn.inc'
      INCLUDE 'sib_mass_cmmn.inc'
      INCLUDE 'sib_width_cmmn.inc'
      INCLUDE 'sib_cnam_cmmn.inc'
c$$$      COMMON /S_CSYDEC/ CBR(223+22), KDEC(1338+6*22), LBARP(99), IDB(99)
c$$$      COMMON /S_MASS1/ AM(99), AM2(99)
c$$$      COMMON /S_CNAM/ NAMP (0:99)
c$$$      CHARACTER NAMP*6
      DIMENSION LL(4)
      
 100  FORMAT(1X,75('-'),/,28X,'SIBYLL DECAY TABLE',/)
      WRITE(LUN,100)
 101  FORMAT(1X,75('-'),/,2X,'PID',1X,'Particle',6X,'Mass',9X,'Width',/,
     +     4X,'Channel',1X,'Br.frac.',1X,'Nf',2X,'MAT',1X,
     +     'Final Particles',/,1X,75('-'))
      WRITE(LUN,101)
      DO L=1,99
         IF(MOD(L,10).EQ.0)WRITE(LUN,101)
         IDC = IDB(L)-1
         NC = 0
         WRITE (LUN,10) L,NAMP(L), AM(L), AW(L)
         IF(IDC+1 .GT. 0)  THEN
            CB = 0.D0
110         IDC=IDC+1
            NC = NC+1
            CBOLD = CB
            CB = CBR(IDC)
            BR = CB-CBOLD
            KD = 6*(IDC-1)+1
            ND = KDEC(KD)
            MAT= KDEC(KD+1)
            DO J=1,ND
               LL(J) = KDEC(KD+1+J)
            ENDDO
            WRITE (LUN,15) NC,BR,ND,MAT, (NAMP(LL(J)),J=1,ND)
            IF (CB .LT. 1.D0)  GOTO 110
         ENDIF
      ENDDO
      RETURN
10    FORMAT(2X,I3,2X,A6,3X,F10.4,3X,F10.4)
15    FORMAT(5X,I2,2X,F9.4,I4,I4,2X,3(A6,2X))
      END



      SUBROUTINE DEC_DEBUG (L,P0, ND, LL, PD)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      SAVE
      INCLUDE 'sib_cnam_cmmn.inc'
c$$$      COMMON /S_CNAM/ NAMP (0:99)
c$$$      CHARACTER*6 NAMP
      DIMENSION P0(5), LL(10), PD(10,5)
      ETOT = 0.D0
      DO J=1,ND
         ETOT = ETOT + PD(J,4)
      ENDDO
      WRITE(*,*)  NAMP(IABS(L)),' -> ', (NAMP(IABS(LL(J))),J=1,ND)
      WRITE(*,*)  ' Ei, Ef = ', P0(4), ETOT, ' L = ', L
      RETURN
      END

      SUBROUTINE DEC_INI
C-----------------------------------------------------------------------
C     decay initialization routine
C     sets which particles should decay and wich should be stable
C-----------------------------------------------------------------------
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INCLUDE 'sib_csydec_cmmn.inc'
      INCLUDE 'sib_cflafr_cmmn.inc'
c$$$      COMMON /S_CSYDEC/ CBR(223+22), KDEC(1338+6*22), LBARP(99), IDB(99)
      
      print *,'-----------------------------------------'
      print *,'SIBYLL DECAYINI: setting particle decays!'
      print *,'-----------------------------------------'
C...  Definition of stable particles
      DO J=4,12
         IDB(J) = -abs(IDB(J))
      ENDDO
c----------------------------------------------------------
c     if the folowing is commented out then all particles
c     except leptons,protons and neutrons are UNSTABLE
c----------------------------------------------------------
c     all particles with t<0.3e-10s are considered unstable
c     i.e. all the mesons from K0s onwards(K0l is stable)
c----------------------------------------------------------
C     K0s stable
      print *,'making K0s stable..'
      IDB(12) = -abs(IDB(12))

C     Lambda/Anti-lambda stable
      print *,'making LAMBDA stable..'
      IDB(39) = -abs(IDB(39))

c     Sigmas stable
      print *,'making SIGMAs stable..'
      do i=34,36
         IDB(i) = -abs(IDB(i))
      enddo
C     Eta stable
c      print *,'making eta stable..'
c      IDB(23) = -abs(IDB(23))

      IF(IPAR(44).eq.1)THEN
c     use pythia decay routine
         write(6,*) 'using PYTHIA decay routine...'
c         call pydec_ini
      endif

      print *,'------------------------------------------'
      end
